fixedRules <- VcfFixedRules(exprs = list(
alleleBias = expression(FILTER == "alleleBias"),
qual20 = expression(QUAL >= 20)
))
active(fixedRules)["qual20"] <- FALSE
validrecords <- summary(evalSeparately(fixedRules, temp_vcf))[1]
allelebias<-summary(evalSeparately(fixedRules, temp_vcf))[2]
return(c(validrecords, allelebias))
}
metadata_df$totalrecords<-NA
metadata_df$allelebiascount<-NA
for (i in 1:nrow(metadata_df)){
results<- analyze_vcf(metadata_df$full_path[i])
metadata_df$totalrecords[i]<-results[1]
metadata_df$allelebiascounts[i]<-results[2]
}
metadata_df<-data.frame(treatment,replicate,full_path)
analyze_vcf <- function(vcfpath){
temp_vcf <- VariantAnnotation::readVcf(vcfpath)
fixedRules <- VcfFixedRules(exprs = list(
alleleBias = expression(FILTER == "alleleBias"),
qual20 = expression(QUAL >= 20)
))
active(fixedRules)["qual20"] <- FALSE
validrecords <- summary(evalSeparately(fixedRules, temp_vcf))[1]
allelebias<-summary(evalSeparately(fixedRules, temp_vcf))[2]
return(c(validrecords, allelebias))
}
metadata_df$totalrecords<-NA
metadata_df$allelebiascount<-NA
for (i in 1:nrow(metadata_df)){
print(i)
results<- analyze_vcf(metadata_df$full_path[i])
metadata_df$totalrecords[i]<-results[1]
metadata_df$allelebiascounts[i]<-results[2]
}
metadata_df<-data.frame(treatment,replicate,full_path)
analyze_vcf <- function(vcfpath){
temp_vcf <- VariantAnnotation::readVcf(vcfpath)
fixedRules <- VcfFixedRules(exprs = list(
alleleBias = expression(FILTER == "alleleBias"),
qual20 = expression(QUAL >= 20)
))
active(fixedRules)["qual20"] <- FALSE
validrecords <- summary(evalSeparately(fixedRules, temp_vcf))[1]
allelebias<-summary(evalSeparately(fixedRules, temp_vcf))[2]
return(c(validrecords, allelebias))
}
metadata_df$totalrecords<-NA
metadata_df$allelebiascount<-NA
library(svMisc)
metadata_df$totalrecords<-NA
metadata_df$allelebiascount<-NA
for (i in 1:nrow(metadata_df)){
progress(i)
results<- analyze_vcf(metadata_df$full_path[i])
metadata_df$totalrecords[i]<-results[1]
metadata_df$allelebiascount[i]<-results[2]
}
library(ggplot2)
allelebiascountplot<-ggplot2(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords))) +
geom_bar()
library(ggplot2)
allelebiascountplot<-ggplot2(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords))) +
geom_bar()
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords))) +
geom_bar()
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = allelebiascount)) +
geom_bar()
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords))) +
geom_point()
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords))) +
geom_bar(stat = 'identity')
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(stat = 'identity')
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(stat = 'coutn')
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(stat = 'count')
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity')
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal()
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias")
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust = -1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = -1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = -90, vjust = -1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 90, vjust = -1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 90, vjust = .5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .5, hjust = .5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .5, hjust = -.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = .5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .75, hjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = .5, hjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = -.5, hjust = .75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 0, hjust=1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, vjust = 0, hjust=-1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1.5))
allelebiascountplot
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.25))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=75))
allelebiascountplot
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.75, vjust = .1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.75, vjust = -.1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.75, vjust = 0))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=.65))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 25, hjust=.75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=.75))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = -.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = -.1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = 0))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = 1))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = 1.5))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 35, hjust=1, vjust = 1.2))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 55, hjust=1, vjust = 1.2))
allelebiascountplot
allelebiascountplot<-ggplot(metadata_df,aes(x = treatment, y = 100 * (allelebiascount/ totalrecords), fill = replicate)) +
geom_bar(position = 'dodge', stat = 'identity') +
theme_minimal() +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2))
allelebiascountplot
sd_allelebias_df<-metadata_df[unique(metadata_df$treatment),]
View(sd_allelebias_df)
sd_allelebias_df<-metadata_df[which(unique(metadata_df$treatment)),]
sd_allelebias_df<-metadata_df[which(duplicated(metadata_df$treatment)),]
View(sd_allelebias_df)
sd_allelebias_df<-metadata_df[which(!duplicated(metadata_df$treatment)),]
View(sd_allelebias_df)
sd_allelebias_df$replicate<-NULL
sd_allelebias_df$full_path<-NULL
for(i in  unique(metadata_df$treatment)){
print(i)
}
for(i in  unique(metadata_df$treatment)){
print(metadata_df$allelebiascount[metadata_df$treatment == i])
}
for(i in  unique(metadata_df$treatment)){
print(mean(metadata_df$allelebiascount[metadata_df$treatment == i]))
}
for(i in  unique(metadata_df$treatment)){
print(summary(metadata_df$allelebiascount[metadata_df$treatment == i]))
}
sd_allelebias_df<-metadata_df[which(!duplicated(metadata_df$treatment)),]
sd_allelebias_df$replicate<-NULL
sd_allelebias_df$full_path<-NULL
sd_allelebias_df$median<-NA
sd_allelebias_df$q1<-NA
sd_allelebias_df$q3<-NA
for(i in  unique(metadata_df$treatment)){
print(summary(metadata_df$allelebiascount[metadata_df$treatment == i]))
match<-which(sd_allelebias_df$treatment == i)
sd_allelebias_df$median[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[3]
sd_allelebias_df$q1[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[2]
sd_allelebias_df$q3[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[5]
}
View(sd_allelebias_df)
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3))
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2))
allelebiascountplot
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2), theme(legend. title = element_blank()) )
allelebiascountplot
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2), theme(legend.title = element_blank()) )
allelebiascountplot
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2), legend.position = "none")
allelebiascountplot
for(i in  unique(metadata_df$treatment)){
print(summary(100 * (metadata_df$allelebiascount[metadata_df$treatment == i]) / metadata_df$totalrecords[metadata_df$treatment == i]))
match<-which(sd_allelebias_df$treatment == i)
sd_allelebias_df$median[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[3]
sd_allelebias_df$q1[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[1]
sd_allelebias_df$q3[match]<-summary(metadata_df$allelebiascount[metadata_df$treatment == i])[6]
}
sd_allelebias_df<-metadata_df[which(!duplicated(metadata_df$treatment)),]
sd_allelebias_df$replicate<-NULL
sd_allelebias_df$full_path<-NULL
sd_allelebias_df$median<-NA
sd_allelebias_df$q1<-NA
sd_allelebias_df$q3<-NA
for(i in  unique(metadata_df$treatment)){
summary<-(summary(100 * (metadata_df$allelebiascount[metadata_df$treatment == i]) / metadata_df$totalrecords[metadata_df$treatment == i]))
match<-which(sd_allelebias_df$treatment == i)
sd_allelebias_df$median[match]<-summary[3]
sd_allelebias_df$q1[match]<-summary[1]
sd_allelebias_df$q3[match]<-summary[6]
}
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2), legend.position = "none")
allelebiascountplot
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
scale_y_continuous(limits = c(0,2))
allelebiascountplot<-ggplot(sd_allelebias_df,aes(x = treatment, y = median, fill = treatment)) +
geom_bar(stat = 'identity') +
theme_minimal() +
geom_errorbar( aes(x=treatment, ymin=q1, ymax=q3)) +
scale_y_continuous(limits = c(0,2)) +
ylab("% of total records marked as allele bias") +
theme(axis.text.x = element_text(angle = 45, hjust=1, vjust = 1.2), legend.position = "none")
allelebiascountplot
